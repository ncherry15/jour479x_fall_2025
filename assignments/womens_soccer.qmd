---
title: "Women's Soccer Data"
---

We'll use this notebook to explore some NCAA women's soccer data and [our questions](https://docs.google.com/spreadsheets/d/1G1AjH2iS6kj3kKHCRi0XVy5Lcm-rahJkeTAToVh9J1g/edit?gid=0#gid=0). First, let's load the tidyverse library:

```{r}
library(tidyverse)
```

We'll want to start with 2025 match data, which is located in [this GitHub repository](https://github.com/dwillis/NCAAWomensSoccerData). We can load the match data directly from GitHub using `read_csv`:


```{r}
matches_2025 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2025.csv")
```

Let's take a look at this data to see what it contains, using `head` and `glimpse`:

```{r}
head(matches_2025)
glimpse(matches_2025)
```

Now, onto the questions using aggregates, which means `group_by` and `summarize`:

1. How many shots in total has Maryland attempted and how many have been on goal? Calculate a percentage of shots on goal.

Maryland attempted 83 shots and 45 of them were on goal. 54.2% was the percentages of shots on goal.

```{r}
matches_2025 |>
  group_by(team) |>
  summarise (
    shots_att = sum(sh_att),
    sog = sum(so_g),
    sht_pct = (sog/shots_att)*100
  )
```


2. What about the same shot stats from last season's first four games? You'll need to load the matches from 2024 - just change the season in the URL - and filter by date to find the first four games.

In the first four games, Maryland attempted 53 shots with 27 of them being on goal. Their shot on goal percentage through the first four games was 50.9%.

```{r}
matches_2024 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2024.csv")

matches_2024 |>
    group_by(team="Maryland Terrapins, Terps") |>
     arrange(date) |>
  head(n=4) |>
 summarise (
    shots_att = sum(sh_att),
    sog = sum(so_g),
    sht_pct = (sog/shots_att)*100 
    )
```  


3. Maryland started 2022 with 4 draws. Have any other teams had as many this season?
Yes, several teams have four or more draws this season, the highest number of draws came from Drake and Navy at seven.

```{r}
matches_2025 |>
  group_by(team, outcome = "draw") |>
  summarise (
    total = n ()
  ) |>
  arrange(desc(total))
```


4. How many total corner kicks has Maryland had so far this season and how many have its opponents have? Calculate the difference between the two totals for every team using group_by, summarize and mutate, then filter to find Maryland's totals.

Maryland has had 28 corner kicks this season while their opponents have only had 22. The difference is 6 kicks.

```{r}
matches_2025 |>
  group_by(team) |>
  summarise (
    corner_kicks = sum(corners),
    opp_corner_kicks = sum(defensive_corners)
  ) |>
  mutate(corner_diff = corner_kicks - opp_corner_kicks)  |>
  filter(team=="Maryland Terrapins, Terps")

```

5. What's the most interesting thing you've seen from these questions?
I find it really interesting that Maryland had only 53 shots in the first four games of 2024 but already has 83 shots in 2025 with just two more games played. That’s a jump of 20 shots in only two extra games, showing a big increase in their offensive activity. It’s impressive how they’re creating even more scoring opportunities this season while maintaining solid accuracy. Their shot on goal percentage has gone up by almost 4%  while taking more shots. It makes me wonder if they are taking smarter shots or the talent is the causation. 

```{r}
swac_teams <- c("Alabama A&M Bulldogs", "Alabama St. Lady Hornets", "Alcorn Lady Braves", "Ark.-Pine Bluff Lady Lions", "Grambling Lady Tigers", "Jackson St. Lady Tigers", "Mississippi Val. Devilettes", "Prairie View Lady Panthers", "Southern U. Lady Jaguars", "Texas Southern Lady Tigers")

swac_matches <- matches_2025 |> 
  filter(team %in% swac_teams)

matches_2025 |> 
  summarise(
    mean_diff = mean(diff),
    mean_opp_goals = mean(defensive_goals),
    mean_sog = mean(so_g),
    mean_opp_sog = mean(defensive_so_g)
    )

swac_matches |> 
  summarise(
    mean_diff = mean(diff),
    mean_opp_goals = mean(defensive_goals),
    mean_sog = mean(so_g),
    mean_opp_sog = mean(defensive_so_g)
    )

big10 <- c("Nebraska Huskers", "Iowa Hawkeyes", "Minnesota Golden Gophers", "Illinois Fighting Illini", "Northwestern Wildcats", "Wisconsin Badgers", "Indiana Hoosiers", "Purdue Boilermakers", "Ohio St. Buckeyes", "Michigan Wolverines", "Michigan St. Spartans", "Penn St. Nittany Lions", "Rutgers Scarlet Knights", "Maryland Terrapins, Terps", "Southern California Trojans", "UCLA Bruins", "Washington Huskies", "Oregon Ducks")

big10_matches <- matches_2025 |> 
  filter(team %in% big10)

big10_matches |> 
  summarise(
    mean_diff = mean(diff),
    mean_opp_goals = mean(defensive_goals),
    mean_sog = mean(so_g),
    mean_opp_sog = mean(defensive_so_g)
    )

big10_matches |> 
  filter(team == "Maryland Terrapins, Terps") |> 
  summarise(
    mean_diff = mean(diff),
    mean_opp_goals = mean(defensive_goals),
    mean_sog = mean(so_g),
    mean_opp_sog = mean(defensive_so_g)
    )
```

Significance Testing
```{r}
matches_2024 <- matches_2024 |> 
  mutate(total_goals =  goals + defensive_goals)

matches_2025 <- matches_2025 |> 
  mutate(total_goals =  goals + defensive_goals)

t.test(matches_2024$total_goals, matches_2025$total_goals)
```
Results:
Based on the t-test output, the mean total goals increased from 2.75 in 2024 to 2.90 in 2025, indicating scoring is slightly up this year. The p-value, 0.00047, is well below 0.05, so this difference is statistically significant. The confidence interval, -0.236 to -0.067, does not include 0, further confirming a significant increase. This change could be due to factors like stronger offensive play, weaker defenses, or the uneven matchups. The season is just starting so we are not well into conference play. As teams continue to play tougher opponents, I anticipate their average goals to decrease slightly. 

Significance Testing for UMD games.
```{r}
maryland_2024 <- matches_2024 |> 
  filter(team == "Maryland Terrapins, Terps") |> 
  mutate(total_goals =  goals + defensive_goals)

maryland_2025 <- matches_2025 |> 
  filter(team == "Maryland Terrapins, Terps") |> 
  mutate(total_goals =  goals + defensive_goals)

t.test(maryland_2024$total_goals, maryland_2025$total_goals)

```

Results:
For Maryland games, the average total goals increased slightly from 2.68 in 2024 to 2.88 in 2025, but the p-value, 0.766, is much higher than 0.05, so this difference is not statistically significant. The confidence interval, -1.54 to 1.16, includes 0, further indicating no significant change. This suggests that, so far, Maryland’s scoring is roughly the same as last year. Since the 2025 season is not yet halfway complete, the results could change as more games are played. Additionally, since the Terps generally perform better against non-conference opponents and have only played one conference game so far, their scoring average may not yet reflect typical performance across the full season.

## Correlations
```{r}
correlations <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2024.csv")

newcorrelations <- correlations |> 
  mutate(
    differential = goals - defensive_goals
    )

newcorrelations |> summarise(correlation = cor(differential, fouls, method="pearson"))

newcorrelations |> summarise(correlation = cor(differential, yellow_cards, method="pearson"))

fit <- lm(differential ~ fouls, data = newcorrelations)
summary(fit)
```
R-squared what percent of differential do fouls account for
Estimate coefficient: what happens whe you change the predictor


```{r}
newcorrelations |> 
  summarise(correlation = cor(differential, so_g, method="pearson"))

net <- lm(differential ~ so_g, data = newcorrelations)
summary(net)
```
##2025 Results
```{r}
correlations_25 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2025.csv")

newcorrelations_25 <- correlations_25 |> 
  mutate(
    differential = goals - defensive_goals
    )

newcorrelations_25 <- newcorrelations_25 |>
  mutate(homeaway = case_when(
    grepl("Away", home_away) ~ 0,
    grepl("Home", home_away) ~ 1)
)

newcorrelations_25 |> 
  summarise(correlation = cor(differential, homeaway, method="pearson"))

fit <- lm(differential ~ homeaway, data = newcorrelations_25)
summary(fit)

```
```{r}
terps_data <- correlations_25 |> 
  mutate(
    differential = goals - defensive_goals,
    homeaway = case_when(
      grepl("Away", home_away) ~ 0,
      grepl("Home", home_away) ~ 1
    )
  ) |> 
  filter(team == "Maryland Terrapins, Terps")

terps_data |> 
  summarise(correlation = cor(differential, homeaway, method="pearson"))

terps_fit <- lm(differential ~ homeaway, data = terps_data)
summary(terps_fit)
```

## Story Pitch
This season, the UMD soccer team has turned Ludwig Field into a nearly unbeatable fortress. They opened the year with three home shutouts, dominating Lehigh 3-0, Saint Francis 5-0 and UMBC 1-0, then edged Navy 2-1 and Indiana 2-1, showing just how much sharper their play is at home. Away games tell a different story, with losses at Old Dominion 0-2, James Madison 0-1, and Penn State 0-4 revealing a clear drop in rhythm and energy. While most teams see only a slight boost at home, the Terps’ performance soars in front of their fans, making their home field advantage one of the strongest in the league. The contrast makes home games a must-watch, showcasing precise attacks, strong defense, and the electric atmosphere that the crowd helps create.

##Residuals
```{r}
matches_2025 <- matches_2025 |> 
  mutate(differential = goals - defensive_goals)
```
```{r}
model <- lm(differential ~ so_g + corners + sh_att + defensive_so_g, data=matches_2025)
summary(model)
```
1. I chose shots on goal and shot attempts because they directly influence goal differential — if a team doesn’t shoot, it cannot increase its chances of scoring. Corners are also an important factor, as they often create scoring opportunities and can lead to more goals. Finally, defensive statistics are critical, since allowing more shots on goal increases the opponent’s chances of scoring and negatively impacts the differential.

The model explains about 57% of the variance in goal differential, showing strong predictive value for this type of data. Shots on goal increase differential, while defensive shots on goal decrease it, making them the most important predictors, whereas corners and total shot attempts add little once shots on goal are included. The residuals range from about -7 to +7, with most falling within ±1, and the residual standard error of 1.54 suggests that predictions are typically within about 1.5 goals of the actual outcome.

2. 
```{r}
matches_2025 <- matches_2025 |>  mutate(predicted = predict(model), residuals = residuals(model))
```

3.
```{r}
matches_2025 |>  arrange(desc(residuals)) |> 
  head(n = 10)
```

4.
```{r}
matches_2025 |>  arrange(residuals) |> 
  head(n = 10)
```
The very first thing that stood out to me was most people over-perform at home and under-perform away which was to be expected. 8/10 over-performers are also high-scoring shutouts so maybe  the opponents were not as good. For the under-performers most people of the games are losses. After all this, I realized a good amount of games appear in both results. 

5. 
```{r}
matches_2025 |>  
  filter(team == "Maryland Terrapins, Terps") |> 
  arrange(desc(residuals)) |> 
  head(n = 10)
```
```{r}
matches_2025 |>  
  filter(team == "Maryland Terrapins, Terps") |> 
  arrange(residuals) |> 
  head(n = 10)
```
I notice that 7/10 over-performances are at Home and 5/10 under-performances are away. I notice that 8 of the games are listed as both an under-performance and over-performance.5 of the under-performances, the Terps scored 0 goals. The number of corners in total is the same among both the top and bottom performances. As to be expected, defensive goals are significantly higher throughout under-performances. Defensive stats as a whole are significantly better.  The differentials are also greater for the under-performances. I would say when the Terps under-perform, they under-perform more than they over-perform when they over-perform. Their biggest over-performance were against Purdue and Indiana, while they under-performed against Penn St. and USC.

The story I would explore is the Terps' place in the Big Ten, 3 of their under-performances came against Big Ten opponents while their top 2 over-performances were also against Big Ten Schools. The 3 losses were away, are the Terps' only losses in the Big Ten are away, can they not compete away from Ludwig Field?

6. The most shocking thing was how games be both over and under-performances. I want to know what categorizes them as both. Could they be over-performing in one of the predictors but ultimately not scoring enough to perform adequately? I would want to only analyze Big Ten games for story purposes. The Terps' started the season off not playing their best opponents, looking only at the Big Ten would give me the opportunity to analyze their true performance.

